import { defineEffect, Effect } from "./effect"
import { damage, targeted } from '../events/damage'
import { Listener, ConsumerArgs } from '../events/listener'
import { blockable } from '../events/damage'

export const vulnerability = Symbol('vulnerability')
export const Vulnerability = defineEffect(vulnerability, {
    name: 'Vulnerability',
    innerColor: '#ee8866',
    outerColor: '#bb3322',
    description: '',
    sides: 3,
    rotation: 0.5,
}, {
    stacked: true, 
    delta: x => x - 1,
    min: 1,
    max: 99,
}, owner => new Listener(
    vulnerability,
    {
        subjects: [owner],
        type: damage,
        tags: [blockable],
    },
    function*({ data }){
        console.log('vuln')
        if(typeof data.damage == 'number'){
            data.damage *= 1.5
        }
    },  
    false,
), [], [damage])